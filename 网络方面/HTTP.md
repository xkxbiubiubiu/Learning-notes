## HTTP

HTTP  超文本传输协议  是客户端与服务器之间数据传输的格式规范

## HTTPS

在http和tcp之间添加一个 SSL 安全套接层 ==> 为http连接提供加密机制

## HTTPS工作过程

1.使用HTTPS请求，要求与服务器建立ssl连接

2.服务器收到请求，返回证书信息

3.协商建立安全等级

4.客户端建立会话秘钥，利用网站公钥将会话秘钥加密

5.服务器利用自己的秘钥 解密会话秘钥

6.服务器利用会话秘钥加密 与客户端通信

## HTTP和HTTPS 区别

1.http协议以明文方式传递内容，不提供任何方式的数据加密

https就是http + 加密处理+ 认证+ 完整性保护

2.端口号http 80    https 443

3.https需要CA申请书

## HTTPS缺点

1.握手阶段比较费时

2.连接缓存不如http高效

3.ca证书要钱

4.加密范围也比较有限

## HTTP工作流程

域名解析

发起tcp3次握手

建立tcp连接发起http请求

服务器端响应HTTP请求，浏览器得到html代码

浏览器解析html代码，并请求html代码中的资源

浏览器渲染页面

## HTTP报文组成

起始行 ，首部字段 ，主体

请求行----（方法，地址，版本信息），请求头，请求体

响应行----（版本号，状态码，原因短语），响应头，响应体

## HTTP中的请求方式

get

post

put 	传输文件

head 获得报文首部

delete 删除文件

options 查询相应url支持的http方法

## 首部字段

通用：   			Date 创建报文时间

​				Connection 连接管理

​				Cache-Control 缓存控制

​				Transfer-Encoding 报文主体传输编码方式

请求首部字段：     Host 请求资源所在的服务器

​				Accept 可处理的媒体类型

​				Accept-language 可接受的语言

响应首部字段	：    location 客服端重新定向到的url

​				server http服务器的安装信息

实体首部字段：	Allow 支持的http方法

​				Content-type 实体主体的类型

​				Content-Encoding 实体主体的编码方式

​				Content-Language 实体主体的语言

​				Content-Length 实体主体的字节长度

## GET 和 POST区别

1. get重点在获取资源，post重点在发送数据

2. get传输的数据挂在url上，用户可见，安全性低

   post通过post机制传输数据，不可见

3. get传输的数据量有限，受url长度限制，但效率高

4. get只支持ASCII字符，传中文可能会出现乱码

   post支持标准字符

5. get可以被缓存，参数可以保留在浏览器历史中

## HTTP状态码

1**			临时响应			100 部分请求已经被接受，表示继续

2** 			成功			200 成功

​							201 成功并建立了新的资源

​							202 已接受尚未处理

​							203 返回信息不完整

​							204请求收到，返回信息为空

3**			重定向 			300 请求资源可在多个url中获取

​							301 永久重定向，请求网页已经永久转移到新位置

​							302 临时重定向

​							303 建议访问其他url

4**			客户端错误		400 格式错误

​							401 未授权

​							403 禁止访问

​							404 请求资源不存在（路径错误）

5**			服务器错误		500 服务器错误

​							503服务器目前无法使用

## HTTP1.0/ 1.1 / 2.0

HTTP1.0  浏览器与服务器只保持短暂连接，发送一个请求，返回一个信息后就关闭连接

HTTP1.1  建立持久连接

​		请求管道化

​		增加缓存处理

​		增加host字段

​		默认 connection ：keep-alive

HTTP2.0  	多路复用

​			二进制分帧

​			首部压缩

​			服务推送，准许服务器在客户端需要数据之前主动发送数据到客户端缓存中

​	优点：提升网站访问速度

​		    降低服务器压力

​	   	    保护网站安全

## TCP三次握手，四次挥手

三次握手：

​	建立连接时，客户端发送syn包（syn=j）到服务器，并进入**SYN_SENT**状态，等待服务器确认 

​	服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入**SYN_RECV**状态 

​	客户端收到服务器的SYN+ACK包，向服务器发送确认包ACK(ack=k+1），此包发送完毕，客户端和服务器进入连接成功状态，完成三次握手。 

四次挥手：

​	客户端发出释放连接报文，并停止发送数据

​	服务器收到报文，发出确认信息

​	服务器处理完数据后，向客户端发送连接释放报文等待确认

​	客户端发出确认

​	服务器收到最后确认后立即进入close状态，后客户端在关闭，客户端要确保服务器接收到最后请求才能关闭

## 为什么是三次握手，两次不可以么

3次握手确保了双方都做好了准备工作

防止已失效的请求报文忽然又传回，产生错误

## 已建立连接，但客户端突然故障怎么办

TCP还设有一个保活计时器，显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。服务器每收到一次客户端的请求后都会重新复位这个计时器，时间通常是设置为2小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个探测报文段，以后每隔75秒钟发送一次。若一连发送10个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。

## HTTP缓存

浏览器在本地磁盘对用户最近请求过的文档进行存储，当访问者再次访问同一页面时，浏览器就可以直接从本地磁盘加载文档。是 web 性能优化的重要手段  

优点：

1. 减少冗余的数据传输
2. 减少服务器负担
3. 加快客户端加载网页的速度

强缓存：用Expires/Cache-Control 来标识 数据缓存时效，当客户端想要获取数据时，缓存数据未失效的情况下，可以直接使用缓存数据 

**对于强制缓存，服务器通知浏览器一个缓存时间，在缓存时间内，下次请求，直接用缓存，不在时间内，执行比较缓存策略。**

**对于比较缓存，将缓存信息中的Etag和Last-Modified通过请求发送给服务器，由服务器校验，返回304状态码时，浏览器直接使用缓存。** 

Last-Modify  == 该资源的最后修改时间 

## TCP长连接

指在一个TCP连接上可以连续发送多个数据包，在TCP连接保持期间，如果没有数据包发送，需要双方发检测包以维持此连接 

连接→数据传输→保持连接(心跳)→数据传输→保持连接(心跳)→……→关闭连接（一个TCP连接通道多个读写通信） 

## HTTP2.0多路复用

HTTP/2引入 二进制数据帧 和 流 的概念 ，多路复用，就是在一个 TCP 连接中可以存在多条流 

## TCP流量控制，拥塞控制

流量控制：就是让发送方的发送速率不要太快，让接收方来得及接收。利用滑动窗口

拥塞是指：数据发送速度超出网络所能承受的极限，经常造成路由器丢包的现象。慢开始，慢重传，快恢复

